branches:
  only:
  - master
  - 7.x
  - 6.x
  - 5.x
language: php
php:
- 5.5
sudo: false
env:
  matrix:
  - UNISH_NO_TIMEOUTS=y UNISH_DRUPAL_MAJOR_VERSION=8 UNISH_DB_URL=mysql://root:@127.0.0.1
    PHPUNIT_ARGS=tests/configTest.php TEST_CHILDREN="drush-ops/config-extra"
  - UNISH_NO_TIMEOUTS=y UNISH_DRUPAL_MAJOR_VERSION=7 UNISH_DB_URL=mysql://root:@127.0.0.1
    PHPUNIT_ARGS=--group=make
  - UNISH_NO_TIMEOUTS=y UNISH_DRUPAL_MAJOR_VERSION=7 UNISH_DB_URL=mysql://root:@127.0.0.1
    PHPUNIT_ARGS=--group=base
  - UNISH_NO_TIMEOUTS=y UNISH_DRUPAL_MAJOR_VERSION=7 UNISH_DB_URL=mysql://root:@127.0.0.1
    PHPUNIT_ARGS=--group=commands
  - UNISH_NO_TIMEOUTS=y UNISH_DRUPAL_MAJOR_VERSION=7 UNISH_DB_URL=mysql://root:@127.0.0.1
    PHPUNIT_ARGS=--group=pm
  - UNISH_NO_TIMEOUTS=y UNISH_DRUPAL_MAJOR_VERSION=7 UNISH_DB_URL=mysql://root:@127.0.0.1
    PHPUNIT_ARGS=--group=quick-drupal
  - UNISH_NO_TIMEOUTS=y UNISH_DRUPAL_MAJOR_VERSION=7 UNISH_DB_URL=mysql://root:@127.0.0.1
    PHPUNIT_ARGS=--exclude-group=base,make,commands,pm,quick-drupal
  - UNISH_NO_TIMEOUTS=y UNISH_DRUPAL_MAJOR_VERSION=8 UNISH_DB_URL=mysql://root:@127.0.0.1
    PHPUNIT_ARGS=--group=make
  - UNISH_NO_TIMEOUTS=y UNISH_DRUPAL_MAJOR_VERSION=8 UNISH_DB_URL=mysql://root:@127.0.0.1
    PHPUNIT_ARGS=--group=base
  - UNISH_NO_TIMEOUTS=y UNISH_DRUPAL_MAJOR_VERSION=8 UNISH_DB_URL=mysql://root:@127.0.0.1
    PHPUNIT_ARGS=--group=commands
  - UNISH_NO_TIMEOUTS=y UNISH_DRUPAL_MAJOR_VERSION=8 UNISH_DB_URL=mysql://root:@127.0.0.1
    PHPUNIT_ARGS=--group=pm
  - UNISH_NO_TIMEOUTS=y UNISH_DRUPAL_MAJOR_VERSION=8 UNISH_DB_URL=mysql://root:@127.0.0.1
    PHPUNIT_ARGS=--group=quick-drupal
  - UNISH_NO_TIMEOUTS=y UNISH_DRUPAL_MAJOR_VERSION=8 UNISH_DB_URL=mysql://root:@127.0.0.1
    PHPUNIT_ARGS=--exclude-group=base,make,commands,pm,quick-drupal TEST_CHILDREN="drush-ops/config-extra"
  global:
  - secure: ZBWA4p/91hyF/Zjc7eiYiN4rxoLIBkLA6FP3VDsRsD0qn1xSv3QYocnRoJnLCdcosBt00hbENlL4cZIjyGEVGYJYRLAuV3UZKW6vqaWEaZCAm9bhKvJeidmDpMeZP0l45fBcauhGvobDkhcbLbzyp6AiZ2PXutyfWt6r4effeQw=
  - secure: o3D3pStzKE18kXLat1TWNAFfiNGE38t8VC3DIDXxDMj/98VNy+B2HRmk6EqHOGc+iRYNSjY/VThrcpOKCj/dc780OmlhyOA33P/O9AxhexS0MqXlWpgaUlxRs12S9V+LFiPmak6aFIflHlkxefTcsAVAmQo200wY18h0ZeRIcv0=
before_install: composer selfupdate
install: composer install
before_script:
- echo "sendmail_path='true'" >> `php --ini | grep "Loaded Configuration" | awk '{print
  $4}'`
- export UNISH_DRUSH="${PWD}/drush"
script: ${PWD}/unish.sh $PHPUNIT_ARGS
after_success: ${PWD}/children.sh $AUTH_TOKEN $TEST_CHILDREN
